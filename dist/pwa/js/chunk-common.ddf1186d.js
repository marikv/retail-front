"use strict";(self["webpackChunkretail_creditbox_md"]=self["webpackChunkretail_creditbox_md"]||[]).push([[64],{3413:(e,t,a)=>{a.d(t,{VB:()=>n,j3:()=>r,jh:()=>d,vy:()=>c,_f:()=>u,BC:()=>m,i:()=>p,Vz:()=>g,M6:()=>_,O2:()=>b,Zg:()=>h,sw:()=>f,ov:()=>w,bq:()=>v,XK:()=>x,F0:()=>y,v2:()=>k,vc:()=>D,XZ:()=>q,Ah:()=>U,QP:()=>S,Zk:()=>F,NU:()=>I,LO:()=>B,Qm:()=>W,Zx:()=>T,C_:()=>H,WW:()=>L,mb:()=>Z});a(5363),a(71),a(7965),a(6016),a(2100);var l=a(6249),i=a(4434),s=a(5616),o=a(5474);const n=0,r=1,d=2,c=3,u=4,m=e=>{const t={};return t[n]="Cerere nouă",t[r]="Cerere în lucru",t[d]="Cerere aprobată",t[c]="Cerere refuzată",t[u]="Contract semnat",t[e]},p=1,g=2,_=3,b=e=>{const t={};return t[p]="Administrator",t[g]="Dealer",t[_]="Executor",t[e]},h=3,f=4,w=5,v=6,x=7,y=8,k=String(o.api.defaults.baseURL).replace("/api","/"),C=(e,t)=>s.ZP.extractDate(e,t),D=(e,t)=>s.ZP.formatDate(e,t),q=e=>D(C(e,"YYYY-MM-DD"),"DD.MM.YYYY"),U={currentYear:(new Date).getFullYear(),days:["Duminică","Luni","Marți","Miercuri","Joi","Vineri","Sâmbătă"],daysShort:["Dum","Lun","Mar","Mie","Joi","Vin","Sâm"],daysVeryShort:["D","L","M","M","J","V","S"],months:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],monthsShort:["Ian","Feb","Mar","Apr","Mai","Iun","Iul","Aug","Sep","Oct","Noi","Dec"],firstDayOfWeek:1},S=(e="Așteptați")=>{l.Z.show({message:e})},F=()=>{l.Z.hide()},I=(e={},t)=>{0===Object.keys(e).length&&t&&t.response&&t.response.data&&(e.timeout=15e3,e.actions=[{icon:"close",color:"white"}],t.response.data.message&&t.response.data.message.indexOf(" Duplicate entry ")>-1?e.message="Acest item deja există în baza de date":t.response.data.data&&t.response.data.data.message&&(e.message=`Eroare: ${t.response.data.data.message}`));const a={icon:void 0!==e.icon?e.icon:"warning",position:e.position||"top",timeout:e.timeout||1e4,progress:void 0===e.progress||e.progress,color:e.color||"red-14",html:e.html||!1,multiLine:e.multiLine||!1,textColor:e.textColor||"white",message:e.message||"Eroare de conexiune",actions:e.actions||[{icon:"close",color:"white"}]};i.Z.create(a)},B=e=>{let t=String(e).replace(".png","_mini.png").replace(".PNG","_mini.PNG").replace(".gif","_mini.gif").replace(".GIF","_mini.GIF").replace(".bmp","_mini.bmp").replace(".BMP","_mini.BMP").replace(".jpg","_mini.jpg").replace(".JPG","_mini.JPG").replace(".svg","_mini.svg").replace(".SVG","_mini.SVG").replace(".jpeg","_mini.jpeg").replace(".JPEG","_mini.JPEG");return t&&t.length&&t[0]&&"/"===t[0]&&(t=t.substring(1)),t},W=e=>{if(!e)return"-";const t=e.substr(0,1);let a=e.length>1?e[1]:"";const l=e.split(" ");return l.length>1&&(a=l[1].substr(0,1)),`${t}${a}`},T=e=>{if(!e)return"#000000";let t,a=0;for(t=0;t<e.length;t+=1)a=e.charCodeAt(t)+((a<<5)-a);let l="#";for(t=0;t<3;t+=1){const e=a>>8*t&255,i=`00${e.toString(16)}`;l+=i.substring(2)}return l},H=e=>{let t=e;return"users"===e?t="Utilizatori":"departments"===e?t="Departamente":"dealers"===e?t="Dileri":"cash"===e?t="Casa":"cashes"===e?t="Касса":"clients"===e?t="Beneficiari":"settings"===e&&(t="Settings"),t},L=(e,t="/print/contract",a="contract")=>{if(e){const l=`${t}/${e}`;S(),(0,o.api)({url:l,method:"GET",responseType:"blob"}).then((t=>{F();const l=window.URL.createObjectURL(new Blob([t.data])),i=document.createElement("a");i.href=l,i.setAttribute("download",`${a}_${e}.pdf`),document.body.appendChild(i),i.click()})).catch((e=>{F(),I({},e)}))}else I({})},Z={set:(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},get:e=>{if(e in localStorage){const t=localStorage.getItem(e);return t?JSON.parse(t):t}return null}}},2663:(e,t,a)=>{a.d(t,{Z:()=>sa});var l=a(3673),i=a(8880),s=a(2323);const o={class:"full-width"},n=(0,l.Uk)("Caută"),r=(0,l._)("br",null,null,-1),d=(0,l.Uk)("Redactează"),c=(0,l._)("br",null,null,-1),u=(0,l.Uk)("Chat"),m=(0,l._)("br",null,null,-1),p=(0,l.Uk)("Șterge"),g=(0,l.Uk)("Deschide"),_=(0,l._)("br",null,null,-1),b=(0,l._)("br",null,null,-1),h=(0,l._)("br",null,null,-1),f={key:0,class:"text-red"},w=(0,l._)("strong",null," Suma Maxima Permisa: ",-1),v=(0,l._)("br",null,null,-1),x=(0,l._)("br",null,null,-1),y=(0,l._)("br",null,null,-1),k=(0,l._)("br",null,null,-1),C=(0,l._)("strong",null,"Suma:",-1),D=(0,l._)("br",null,null,-1);function q(e,t,a,q,U,S){const F=(0,l.up)("q-icon"),I=(0,l.up)("q-input"),B=(0,l.up)("q-tooltip"),W=(0,l.up)("q-btn"),T=(0,l.up)("q-badge"),H=(0,l.up)("q-td"),L=(0,l.up)("q-img"),Z=(0,l.up)("q-avatar"),N=(0,l.up)("q-table"),z=(0,l.up)("bid-dialog");return(0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(N,{class:"full-width",flat:!0,title:"Cereri trimise",rows:e.rows,columns:e.columns,"row-key":"id",filter:e.filter,pagination:e.pagination,"onUpdate:pagination":t[1]||(t[1]=t=>e.pagination=t),loading:e.loading,"binary-state-sort":"","no-data-label":"Nu sunt înregistrări","rows-per-page-label":"Înregistrări pe pagină","rows-per-page-options":[30,50,100,200,500,1e3,0],onRequest:e.onRequest,"card-class":"text-primary","table-class":"text-grey-8","table-header-class":"bg-indigo-1 text-primary",bordered:""},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(I,{outlined:"","bg-color":"white",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filter=t),onKeyup:(0,i.D2)(e.onRequest,["enter"]),placeholder:"Caută"},{append:(0,l.w5)((()=>[(0,l.Wm)(F,{name:"search"})])),_:1},8,["modelValue","onKeyup"]),(0,l.Wm)(W,{icon:"search",round:"",onClick:e.onRequest,class:"q-ml-lg",color:"primary"},{default:(0,l.w5)((()=>[(0,l.Wm)(B,null,{default:(0,l.w5)((()=>[n])),_:1})])),_:1},8,["onClick"])])),"body-cell-id":(0,l.w5)((t=>[(0,l.Wm)(H,{props:t,class:"actions-td text-center"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(t.row.id),1),r,(0,l.Wm)(W,{dense:"",round:"",flat:"",size:"md",color:"positive",onClick:a=>e.editRow(t.row.id,!1),icon:"edit"},{default:(0,l.w5)((()=>[(0,l.Wm)(B,null,{default:(0,l.w5)((()=>[d])),_:1})])),_:2},1032,["onClick"]),c,(0,l.Wm)(W,{dense:"",round:"",flat:"",size:"md",color:e.unreadChats[t.row.id]?"negative":"positive",onClick:a=>e.editRow(t.row.id,!0),icon:e.unreadChats[t.row.id]?"chat_bubble":"chat_bubble_outline"},{default:(0,l.w5)((()=>[e.unreadChats[t.row.id]?((0,l.wg)(),(0,l.j4)(T,{key:0,color:"orange",floating:"",transparent:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.unreadChats[t.row.id]),1)])),_:2},1024)):(0,l.kq)("",!0),(0,l.Wm)(B,null,{default:(0,l.w5)((()=>[u])),_:1})])),_:2},1032,["color","onClick","icon"]),m,e.isDealer?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(W,{key:0,dense:"",round:"",flat:"",size:"md",color:"negative",onClick:a=>e.deleteRow(t),icon:"delete"},{default:(0,l.w5)((()=>[(0,l.Wm)(B,null,{default:(0,l.w5)((()=>[p])),_:1})])),_:2},1032,["onClick"]))])),_:2},1032,["props"])])),"body-cell-dealer_name":(0,l.w5)((t=>[(0,l.Wm)(H,{props:t,class:"props-td"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{size:"md",onClick:a=>e.editRow(t.row.id),class:"cursor-pointer bg-white q-mr-sm",style:{border:"1px solid white"}},{default:(0,l.w5)((()=>[e.getLogo(t.row.logo)?((0,l.wg)(),(0,l.j4)(L,{key:0,src:e.getLogo(t.row.logo),alt:""},null,8,["src"])):((0,l.wg)(),(0,l.iD)("div",{key:1,style:(0,s.j5)(`color: ${e.getColorForLogo(t.row.dealer_name)}`)},(0,s.zw)(e.getInitialsForLogo(t.row.dealer_name)),5)),(0,l.Wm)(B,null,{default:(0,l.w5)((()=>[g])),_:1})])),_:2},1032,["onClick"]),(0,l._)("strong",null,(0,s.zw)(t.row.dealer_name),1),_,(0,l.Uk)(" User: "+(0,s.zw)(t.row.user_name),1),b,(0,l.Uk)(" "+(0,s.zw)(t.row.type_credits_name),1),h,(0,l.Uk)(" "+(0,s.zw)(t.row.created_at2)+" ",1),t.row.sum_max_permis?((0,l.wg)(),(0,l.iD)("div",f,[w,(0,l.Uk)(" "+(0,s.zw)(t.row.sum_max_permis),1)])):(0,l.kq)("",!0)])),_:2},1032,["props"])])),"body-cell-phone1":(0,l.w5)((t=>[(0,l.Wm)(H,{props:t,class:"props-td"},{default:(0,l.w5)((()=>[(0,l._)("strong",null,(0,s.zw)(t.row.client_last_name)+" "+(0,s.zw)(t.row.client_first_name),1),v,(0,l.Uk)(" Tel: "+(0,s.zw)(t.row.phone1),1),x,(0,l.Uk)(" IDNP: "+(0,s.zw)(t.row.buletin_idnp),1),y,(0,l.Wm)(T,{color:e.getStatusBadgeColor(t.row.status_id),"text-color":e.getStatusBadgeTextColor(t.row.status_id)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.getBidStatus(t.row.status_id)),1)])),_:2},1032,["color","text-color"]),k,C,(0,l.Uk)(" "+(0,s.zw)(t.row.imprumut),1),D])),_:2},1032,["props"])])),_:1},8,["rows","columns","filter","pagination","loading","onRequest"]),(0,l.Wm)(z,{ref:"BidDialogRef"},null,512)])}a(5363),a(71);var U=a(1959),S=a(3617),F=a(5474),I=a(3413),B=a(8825);const W={class:"text-subtitle1"},T=(0,l._)("span",{class:"text-blue-grey"},"Cerere",-1),H={class:(0,s.C_)("q-ml-md")},L={class:"row"},Z=(0,l._)("div",{class:"col-xl-4 col-lg-4 col-md-4 col-sm-12 col-xs-12 q-pa-xs"},null,-1),N={class:"col-xl-4 col-lg-4 col-md-4 col-sm-12 col-xs-12 q-pa-xs text-center"},z=(0,l._)("div",{class:"col-xl-4 col-lg-4 col-md-4 col-sm-12 col-xs-12 q-pa-xs"},null,-1),P={class:"col-xl-9 col-lg-9 col-md-9 col-sm-12 col-xs-12 q-pa-xs"},V={class:"text-primary",style:{"font-size":"20px"}},A=(0,l._)("span",{class:"text-grey q-mx-md"},"/",-1),E={class:"text-black",style:{"font-size":"16px"}},j={style:{"font-size":"23px"}},O={style:{"font-weight":"bold"}},Q=(0,l.Uk)(" Lei "),M=(0,l._)("span",{class:"text-grey q-mx-md"},"/",-1),R={class:"text-black",style:{"font-size":"20px"}},$={style:{"font-weight":"bold"}},Y=(0,l._)("span",{style:{"font-size":"16px"}}," Luni",-1),G={class:"text-grey q-ml-lg"},K={key:0,class:"col-xl-3 col-lg-3 col-md-3 col-sm-12 col-xs-12 q-pa-xs text-right"},J={class:"col-12 q-pl-sm"},X={class:"bg-green-1 q-pa-sm text-grey-7 full-height q-card--bordered rounded-borders text-caption"},ee={key:0,class:"col-12",style:{"text-align":"center"}},te=(0,l._)("span",null,"Graficul de rambursare",-1),ae={key:1,class:"col-12"},le={style:{"max-width":"700px",width:"100%",margin:"auto"},class:"row"},ie=(0,l._)("div",{class:"col-2 text-subtitle2"},"Data",-1),se=(0,l._)("div",{class:"col-2 text-subtitle2 text-right"},"Suma",-1),oe=(0,l._)("div",{class:"col-2 text-subtitle2 text-right"},"Dob.",-1),ne=(0,l._)("div",{class:"col-2 text-subtitle2 text-right"},"Com.",-1),re=(0,l._)("div",{class:"col-2 text-subtitle2 text-right"},"Com.admin",-1),de=(0,l._)("div",{class:"col-2 text-subtitle2 text-right"},"Total",-1),ce={class:"col-2"},ue={class:"col-2 text-right"},me={class:"col-2 text-right"},pe={class:"col-2 text-right"},ge={class:"col-2 text-right"},_e={class:"col-2 text-right"},be=(0,l._)("div",{class:"col-2 text-subtitle2"},"Total",-1),he={class:"col-2 text-subtitle2 text-right"},fe={class:"col-2 text-subtitle2 text-right"},we={class:"col-2 text-subtitle2 text-right"},ve={class:"col-2 text-subtitle2 text-right"},xe={class:"col-2 text-subtitle2 text-right"},ye={key:2,class:"col-12",style:{"text-align":"center"}},ke=(0,l._)("span",null,"Închide Graficul de rambursare",-1),Ce={class:"col-12"},De={key:0},qe={class:"text-primary",style:{"font-size":"18px"}},Ue={class:"text-grey q-ml-lg"},Se=(0,l._)("div",{class:"col-12 q-mt-lg"},[(0,l._)("span",{class:"text-primary",style:{"font-size":"18px"}},"Client")],-1),Fe={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},Ie={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},Be={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},We={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},Te={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},He={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},Le={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},Ze={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},Ne={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},ze={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},Pe=(0,l._)("div",{class:"col-12 text-primary"},"Persoana de contact",-1),Ve={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},Ae={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},Ee={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},je={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-xs"},Oe=(0,l._)("div",{class:"col-12"},null,-1),Qe={key:2,class:"col-12 text-red"},Me={key:3,class:"col-12 text-green-8 text-subtitle1"},Re=(0,l.Uk)(" Cerere aprobată "),$e={class:"text-green-10 text-subtitle2 q-ml-xl"},Ye=(0,l.Uk)(" Suma maximă permisă: "),Ge={key:4,class:"col-12 row"},Ke={class:"col-12"},Je={class:"col-5"},Xe={class:"col-7 q-pt-md"},et={class:"col-5"},tt={class:"col-7 q-pt-md"},at={class:"col-5"},lt={class:"col-7 q-pt-md"},it={class:"col-5"},st={class:"col-7 q-pt-md"},ot={class:"col-5"},nt={class:"col-7 q-pt-md"},rt={key:5,class:"col-12 rounded-borders bg-green-2 row q-pa-md"},dt={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-sm"},ct={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-sm"},ut=(0,l._)("div",{class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-sm"},null,-1),mt={class:"col-xl-3 col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pa-sm text-right"};function pt(e,t,a,i,o,n){const r=(0,l.up)("q-toolbar-title"),d=(0,l.up)("header-tabs-for-forms"),c=(0,l.up)("q-space"),u=(0,l.up)("q-btn"),m=(0,l.up)("q-toolbar"),p=(0,l.up)("q-separator"),g=(0,l.up)("q-icon"),_=(0,l.up)("q-badge"),b=(0,l.up)("q-img"),h=(0,l.up)("q-avatar"),f=(0,l.up)("q-input"),w=(0,l.up)("file-upload"),v=(0,l.up)("q-tab-panel"),x=(0,l.up)("chat"),y=(0,l.up)("files-form"),k=(0,l.up)("logs-table-for-forms"),C=(0,l.up)("q-tab-panels"),D=(0,l.up)("q-card-section"),q=(0,l.up)("q-card-actions"),U=(0,l.up)("q-card"),S=(0,l.up)("q-dialog");return(0,l.wg)(),(0,l.j4)(S,{ref:"dialogRef",modelValue:i.isOpenedLocal,"onUpdate:modelValue":t[37]||(t[37]=e=>i.isOpenedLocal=e),"full-height":"",persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{class:"q-dialog-plugin",style:{width:"100%","max-width":"1100px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{class:(0,s.C_)("q-pr-xs")},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("span",W,[T,(0,l._)("strong",H,(0,s.zw)(i.id),1)])])),_:1}),(0,l.Wm)(d,{modelValue:i.tab,"onUpdate:modelValue":t[0]||(t[0]=e=>i.tab=e),tabs:i.tabs},null,8,["modelValue","tabs"]),(0,l.Wm)(c),(0,l.Wm)(u,{icon:"close",flat:"",round:"",dense:"",onClick:i.onCancelClick},null,8,["onClick"])])),_:1}),(0,l.Wm)(p),(0,l.Wm)(D,{style:{"min-height":"calc(100vh - 165px)","max-height":"calc(100vh - 165px)"},class:"scroll"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{modelValue:i.tab,"onUpdate:modelValue":t[36]||(t[36]=e=>i.tab=e),animated:"","keep-alive":!1},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"general",class:"q-pa-none"},{default:(0,l.w5)((()=>[(0,l._)("div",L,[Z,(0,l._)("div",N,[i.bidData&&i.bidData.user_id&&i.statusId===i.BID_STATUS_NEW&&(i.isExecutor||i.isAdmin)?((0,l.wg)(),(0,l.j4)(u,{key:0,size:"lg",color:"positive",onClick:t[1]||(t[1]=e=>i.setBidStatus(i.BID_STATUS_IN_WORK)),label:"Ia cererea în lucru"})):(0,l.kq)("",!0)]),z,(0,l._)("div",P,[(0,l._)("span",V,(0,s.zw)(i.bidData&&i.bidData.type_credit?i.bidData.type_credit.name:""),1),A,(0,l._)("span",E,[(0,l._)("span",j,[(0,l._)("span",O,(0,s.zw)(i.bidData&&i.bidData.imprumut?i.bidData.imprumut:"0"),1)]),Q]),M,(0,l._)("span",R,[(0,l._)("span",$,(0,s.zw)(i.bidData&&i.bidData.months?i.bidData.months:"0"),1),Y]),(0,l._)("span",G,(0,s.zw)(i.dateToDot(i.bidData.created_at)),1)]),i.isDealer||i.bidData.status_id===i.BID_STATUS_REFUSED?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",K,[(0,l.Wm)(u,{color:"primary",onClick:i.openPopupForSumChange,label:"Schimbă suma cererii"},null,8,["onClick"])])),(0,l._)("div",J,[(0,l._)("div",X,(0,s.zw)(i.bidData&&i.bidData.type_credit?i.bidData.type_credit.description_mini:""),1)]),i.bidData&&i.bidData.bid_months?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[i.showAllBidMonths?((0,l.wg)(),(0,l.iD)("div",ae,[(0,l._)("div",le,[ie,se,oe,ne,re,de,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.bidData.bid_months,((e,t)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:`res-${t}`},[(0,l._)("div",ce,(0,s.zw)(i.dateToDot(e.date)),1),(0,l._)("div",ue,(0,s.zw)(e.imprumut_per_luna),1),(0,l._)("div",me,(0,s.zw)(e.dobinda_per_luna),1),(0,l._)("div",pe,(0,s.zw)(e.comision_per_luna),1),(0,l._)("div",ge,(0,s.zw)(e.comision_admin_per_luna),1),(0,l._)("div",_e,(0,s.zw)(e.total_per_luna),1)],64)))),128)),be,(0,l._)("div",he,(0,s.zw)(i.bidData.imprumut),1),(0,l._)("div",fe,(0,s.zw)(i.bidData.total_dobinda),1),(0,l._)("div",we,(0,s.zw)(i.bidData.total_comision),1),(0,l._)("div",ve,(0,s.zw)(i.bidData.total_comision_admin),1),(0,l._)("div",xe,(0,s.zw)(i.bidData.total),1)])])):((0,l.wg)(),(0,l.iD)("div",ee,[i.showAllBidMonths?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(_,{key:0,color:"positive",style:{margin:"auto"},class:"cursor-pointer",onClick:t[2]||(t[2]=e=>i.showAllBidMonths=!0)},{default:(0,l.w5)((()=>[te,(0,l.Wm)(g,{name:"expand_more"})])),_:1}))])),i.showAllBidMonths?((0,l.wg)(),(0,l.iD)("div",ye,[(0,l.Wm)(_,{color:"positive",style:{margin:"auto"},class:"cursor-pointer",onClick:t[3]||(t[3]=e=>i.showAllBidMonths=!1)},{default:(0,l.w5)((()=>[ke,(0,l.Wm)(g,{name:"expand_less"})])),_:1})])):(0,l.kq)("",!0)],64)):(0,l.kq)("",!0),(0,l._)("div",Ce,[i.bidData.dealer?((0,l.wg)(),(0,l.iD)("div",De,[(0,l.Wm)(h,{size:"md",class:"cursor-pointer bg-white q-mr-sm",style:{border:"1px solid white"}},{default:(0,l.w5)((()=>[i.getLogo(i.bidData.dealer.logo)?((0,l.wg)(),(0,l.j4)(b,{key:0,src:i.getLogo(i.bidData.dealer.logo),alt:""},null,8,["src"])):((0,l.wg)(),(0,l.iD)("div",{key:1,style:(0,s.j5)(`color: ${i.getColorForLogo(i.bidData.dealer.name)}`)},(0,s.zw)(i.getInitialsForLogo(i.bidData.dealer.name)),5))])),_:1}),(0,l._)("span",qe,(0,s.zw)(i.bidData.dealer.name),1),(0,l._)("span",Ue,"User: "+(0,s.zw)(i.bidData.user.name),1)])):(0,l.kq)("",!0)]),Se,(0,l._)("div",Fe,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,error:i.clientFirstNameHasError,onBlur:t[4]||(t[4]=e=>i.clientFirstNameHasError=!1),onFocus:t[5]||(t[5]=e=>i.clientFirstNameHasError=!1),type:"text",label:"Nume",modelValue:i.clientFirstName,"onUpdate:modelValue":t[6]||(t[6]=e=>i.clientFirstName=e)},null,8,["disable","error","modelValue"])]),(0,l._)("div",Ie,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,error:i.clientLastNameHasError,onBlur:t[7]||(t[7]=e=>i.clientLastNameHasError=!1),onFocus:t[8]||(t[8]=e=>i.clientLastNameHasError=!1),type:"text",label:"Prenume",modelValue:i.clientLastName,"onUpdate:modelValue":t[9]||(t[9]=e=>i.clientLastName=e)},null,8,["disable","error","modelValue"])]),(0,l._)("div",Be,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,error:i.clientPhoneHasError,onBlur:t[10]||(t[10]=e=>i.clientPhoneHasError=!1),onFocus:t[11]||(t[11]=e=>i.clientPhoneHasError=!1),type:"text",label:"Telefon",modelValue:i.clientPhone,"onUpdate:modelValue":t[12]||(t[12]=e=>i.clientPhone=e)},null,8,["disable","error","modelValue"])]),(0,l._)("div",We,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,error:i.clientBirthDateHasError,onBlur:t[13]||(t[13]=e=>i.clientBirthDateHasError=!1),onFocus:t[14]||(t[14]=e=>i.clientBirthDateHasError=!1),type:"text",mask:"##.##.####",label:"Data de naștere",modelValue:i.clientBirthDate,"onUpdate:modelValue":t[15]||(t[15]=e=>i.clientBirthDate=e)},null,8,["disable","error","modelValue"])]),(0,l._)("div",Te,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,error:i.clientBuletinSNHasError,onBlur:t[16]||(t[16]=e=>i.clientBuletinSNHasError=!1),onFocus:t[17]||(t[17]=e=>i.clientBuletinSNHasError=!1),type:"text",rules:[e=>9===e.length||"9 caractere"],label:"Buletin S/N",modelValue:i.clientBuletinSN,"onUpdate:modelValue":t[18]||(t[18]=e=>i.clientBuletinSN=e)},null,8,["disable","error","rules","modelValue"])]),(0,l._)("div",He,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,error:i.clientBuletinIDNPHasError,onBlur:t[19]||(t[19]=e=>i.clientBuletinIDNPHasError=!1),onFocus:t[20]||(t[20]=e=>i.clientBuletinIDNPHasError=!1),type:"text",rules:[e=>13===e.length||"13 cifre"],label:"Buletin IDNP",modelValue:i.clientBuletinIDNP,"onUpdate:modelValue":t[21]||(t[21]=e=>i.clientBuletinIDNP=e)},null,8,["disable","error","rules","modelValue"])]),(0,l._)("div",Le,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,error:i.clientLocalitateHasError,onBlur:t[22]||(t[22]=e=>i.clientLocalitateHasError=!1),onFocus:t[23]||(t[23]=e=>i.clientLocalitateHasError=!1),type:"text",label:"Localitate",modelValue:i.clientLocalitate,"onUpdate:modelValue":t[24]||(t[24]=e=>i.clientLocalitate=e)},null,8,["disable","error","modelValue"])]),(0,l._)("div",Ze,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,type:"text",label:"Strada",modelValue:i.clientStreet,"onUpdate:modelValue":t[25]||(t[25]=e=>i.clientStreet=e)},null,8,["disable","modelValue"])]),(0,l._)("div",Ne,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,type:"text",label:"Bloc",modelValue:i.clientHouse,"onUpdate:modelValue":t[26]||(t[26]=e=>i.clientHouse=e)},null,8,["disable","modelValue"])]),(0,l._)("div",ze,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,type:"text",label:"Apartament",modelValue:i.clientFlat,"onUpdate:modelValue":t[27]||(t[27]=e=>i.clientFlat=e)},null,8,["disable","modelValue"])]),Pe,(0,l._)("div",Ve,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,type:"text",label:"Nume",modelValue:i.clientFirstNameContPers1,"onUpdate:modelValue":t[28]||(t[28]=e=>i.clientFirstNameContPers1=e)},null,8,["disable","modelValue"])]),(0,l._)("div",Ae,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,type:"text",label:"Prenume",modelValue:i.clientLastNameContPers1,"onUpdate:modelValue":t[29]||(t[29]=e=>i.clientLastNameContPers1=e)},null,8,["disable","modelValue"])]),(0,l._)("div",Ee,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,type:"text",label:"Telefon",modelValue:i.clientPhoneContPers1,"onUpdate:modelValue":t[30]||(t[30]=e=>i.clientPhoneContPers1=e)},null,8,["disable","modelValue"])]),(0,l._)("div",je,[(0,l.Wm)(f,{dense:"",outlined:"",disable:i.disableClientInputs,type:"text",label:"Cine este",modelValue:i.clientWhoIsContPers1,"onUpdate:modelValue":t[31]||(t[31]=e=>i.clientWhoIsContPers1=e)},null,8,["disable","modelValue"])]),Oe,i.bidData.status_id===i.BID_STATUS_REFUSED?((0,l.wg)(),(0,l.iD)("div",Qe," Cerere refuzată ")):(0,l.kq)("",!0),i.bidData.status_id===i.BID_STATUS_APPROVED?((0,l.wg)(),(0,l.iD)("div",Me,[Re,(0,l._)("span",$e,[Ye,(0,l._)("strong",null,(0,s.zw)(i.sumMaximPermis),1)])])):(0,l.kq)("",!0),i.bidData.status_id===i.BID_STATUS_APPROVED?((0,l.wg)(),(0,l.iD)("div",Ge,[(0,l._)("div",Ke,[(0,l.Wm)(u,{size:"md",onClick:t[32]||(t[32]=e=>i.printContract()),icon:"print",label:"Print Contract",class:"q-ma-md"})]),(0,l._)("div",Je,[(0,l.Wm)(w,{module:"bid_id",typeId:i.fileTypeSignContract,onOnUploaded:i.onFileUploaded,id:i.id},{button:(0,l.w5)((()=>[(0,l.Wm)(u,{size:"md",icon:"attach_file",label:"Adaugă contractul semnat",class:"q-ma-md"})])),_:1},8,["typeId","onOnUploaded","id"])]),(0,l._)("div",Xe,(0,s.zw)(i.fileUploadedResponses[String(i.fileTypeSignContract)].name?i.fileUploadedResponses[String(i.fileTypeSignContract)].name:""),1),(0,l._)("div",et,[(0,l.Wm)(w,{module:"bid_id",typeId:i.fileTypeBuletin1,onOnUploaded:i.onFileUploaded,id:i.id},{button:(0,l.w5)((()=>[(0,l.Wm)(u,{size:"md",icon:"attach_file",label:"Adaugă copia actului de identitate 1",class:"q-ma-md"})])),_:1},8,["typeId","onOnUploaded","id"])]),(0,l._)("div",tt,(0,s.zw)(i.fileUploadedResponses[String(i.fileTypeBuletin1)].name?i.fileUploadedResponses[String(i.fileTypeBuletin1)].name:""),1),(0,l._)("div",at,[(0,l.Wm)(w,{module:"bid_id",typeId:i.fileTypeBuletin2,onOnUploaded:i.onFileUploaded,id:i.id},{button:(0,l.w5)((()=>[(0,l.Wm)(u,{size:"md",icon:"attach_file",label:"Adaugă copia actului de identitate 2",class:"q-ma-md"})])),_:1},8,["typeId","onOnUploaded","id"])]),(0,l._)("div",lt,(0,s.zw)(i.fileUploadedResponses[String(i.fileTypeBuletin2)].name?i.fileUploadedResponses[String(i.fileTypeBuletin2)].name:""),1),(0,l._)("div",it,[(0,l.Wm)(w,{module:"bid_id",typeId:i.fileTypeOthers1,onOnUploaded:i.onFileUploaded,id:i.id},{button:(0,l.w5)((()=>[(0,l.Wm)(u,{size:"md",icon:"attach_file",label:"Adaugă orice alt fișier 1",class:"q-ma-md"})])),_:1},8,["typeId","onOnUploaded","id"])]),(0,l._)("div",st,(0,s.zw)(i.fileUploadedResponses[String(i.fileTypeOthers1)].name?i.fileUploadedResponses[String(i.fileTypeOthers1)].name:""),1),(0,l._)("div",ot,[(0,l.Wm)(w,{module:"bid_id",typeId:i.fileTypeOthers2,onOnUploaded:i.onFileUploaded,id:i.id},{button:(0,l.w5)((()=>[(0,l.Wm)(u,{size:"md",icon:"attach_file",label:"Adaugă orice alt fișier 2",class:"q-ma-md"})])),_:1},8,["typeId","onOnUploaded","id"])]),(0,l._)("div",nt,(0,s.zw)(i.fileUploadedResponses[String(i.fileTypeOthers2)].name?i.fileUploadedResponses[String(i.fileTypeOthers2)].name:""),1)])):(0,l.kq)("",!0),i.isDealer||i.bidData.status_id!==i.BID_STATUS_IN_WORK?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",rt,[(0,l._)("div",dt,[(0,l.Wm)(f,{outlined:"",type:"number",class:"text-subtitle1 text-primary bg-white","input-class":"",modelValue:i.sumMaximPermis,"onUpdate:modelValue":t[33]||(t[33]=e=>i.sumMaximPermis=e),label:"Suma maximă permisă"},null,8,["modelValue"])]),(0,l._)("div",ct,[(0,l.Wm)(u,{label:"Aprob",size:"lg",onClick:t[34]||(t[34]=e=>i.setBidStatus(i.BID_STATUS_APPROVED)),color:"positive"})]),ut,(0,l._)("div",mt,[(0,l.Wm)(u,{label:"Refuz",size:"lg",onClick:t[35]||(t[35]=e=>i.setBidStatus(i.BID_STATUS_REFUSED)),color:"negative"})])]))])])),_:1}),(0,l.Wm)(v,{name:"chat",class:"q-pa-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{bid_id:i.id},null,8,["bid_id"])])),_:1}),(0,l.Wm)(v,{name:"files",class:"q-pa-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{ref:"FilesForm",bid_id:i.id},null,8,["bid_id"])])),_:1}),(0,l.Wm)(v,{name:"user_tab_logs",class:"q-pa-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{entity_id:i.id,entity_name:"bids"},null,8,["entity_id"])])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(p),(0,l.Wm)(q,{align:"right"},{default:(0,l.w5)((()=>[i.bidData.status_id===i.BID_STATUS_APPROVED?((0,l.wg)(),(0,l.j4)(u,{key:0,label:"Trimite contractul semnat / închide cererea",color:"primary",onClick:i.sendBidToContract},null,8,["onClick"])):(0,l.kq)("",!0),(0,l.Wm)(u,{label:"Închide",onClick:i.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}a(6245);const gt={class:"col-12 row flex column relative-position",style:{"min-height":"calc(100vh - 200px)","max-height":"calc(100vh - 200px)"}},_t={key:0,class:"q-pa-md column col-12 text-center justify-center"},bt=["src"],ht={class:"full-width flex no-wrap items-end"},ft=(0,l.Uk)("Adaugă fișier"),wt=(0,l.Uk)("Trimite"),vt=["id","name"];function xt(e,t,a,i,o,n){const r=(0,l.up)("q-circular-progress"),d=(0,l.up)("q-chat-message"),c=(0,l.up)("q-scroll-area"),u=(0,l.up)("q-tooltip"),m=(0,l.up)("q-btn"),p=(0,l.up)("q-input"),g=(0,l.up)("q-toolbar");return(0,l.wg)(),(0,l.iD)("div",gt,[(0,l.Wm)(c,{visible:"",ref:"scrollAreaRef",onScroll:i.scrollHandlerArea,style:{"min-height":"calc(100vh - 250px)","max-height":"calc(100vh - 250px)",height:"calc(100vh - 250px)"}},{default:(0,l.w5)((()=>[i.chatMessagesLoad?((0,l.wg)(),(0,l.iD)("div",_t,[(0,l.Wm)(r,{indeterminate:"",size:"50px",color:"primary",class:"q-mx-auto q-my-auto"})])):(0,l.kq)("",!0),(0,l._)("div",{class:(0,s.C_)(["q-pa-md column col justify-end",{invisible:!1}]),id:"chatArea",style:{}},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.messages,((e,t)=>((0,l.wg)(),(0,l.j4)(d,{key:t,text:[e.message],sent:e.from_user_id===i.currentUser.id,name:i.getChatMessageUser(e),"name-html":"","text-html":!!e.file_id,stamp:e.created_at2,"bg-color":e.from_user_id===i.currentUser.id?"green-2":""+(e.read?"indigo-2":"indigo-3")},{avatar:(0,l.w5)((()=>[i.getAvatar(e.from_user_avatar)?((0,l.wg)(),(0,l.iD)("img",{key:0,src:i.getAvatar(e.from_user_avatar),class:(0,s.C_)("q-message-avatar\n               q-message-avatar--"+(e.from_user_id===i.currentUser.id?"sent":"received")),alt:""},null,10,bt)):((0,l.wg)(),(0,l.iD)("div",{key:1,class:(0,s.C_)("q-message-avatar\n               q-message-avatar--"+(e.from_user_id===i.currentUser.id?"sent":"received")),style:(0,s.j5)(`color: ${i.getColorForLogo(e.from_user_name)}`)},(0,s.zw)(i.getInitialsForLogo(e.from_user_name)),7))])),_:2},1032,["text","sent","name","text-html","stamp","bg-color"])))),128))])])),_:1},8,["onScroll"]),(0,l.Wm)(g,{class:"",style:{position:"absolute",bottom:"0"}},{default:(0,l.w5)((()=>[(0,l._)("div",ht,[(0,l.Wm)(p,{ref:"newMessageRef","bg-color":"green-2",rounded:"",modelValue:i.newMessage,"onUpdate:modelValue":t[1]||(t[1]=e=>i.newMessage=e),placeholder:"Message",class:"full-width",dense:"",outlined:"",type:"textarea",autogrow:""},{before:(0,l.w5)((()=>[(0,l.Wm)(m,{flat:"",round:"",color:"primary",class:"q-mt-sm",onClick:t[0]||(t[0]=e=>i.launchFilePicker()),icon:"attach_file"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[ft])),_:1})])),_:1})])),after:(0,l.w5)((()=>[(0,l.Wm)(m,{round:"",dense:"",color:"primary",flat:"",onClick:i.sendMessage,icon:"send"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[wt])),_:1})])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])])),_:1}),(0,l._)("input",{type:"file",ref:"file",multiple:"",id:i.uploadFieldId,name:i.uploadFieldName,onChange:t[2]||(t[2]=e=>i.onFileChange(e.target.name,e.target.files)),style:{display:"none"}},null,40,vt)])}a(7070);const yt={name:"Chat",props:{bid_id:{type:Number,default:null}},setup(e){const t=(0,S.oR)(),a=(0,U.iH)([]),i=(0,U.iH)({}),s=(0,U.iH)({}),o=(0,U.iH)(0),n=(0,U.iH)(null),r=(0,U.iH)(!1),d=(0,U.iH)(null),c=(0,U.iH)("fileForUpload"),u=(0,U.iH)(40480),m=(0,U.iH)(""),p=(0,l.Fl)((()=>t.getters["auth/getUser"])),g=()=>{n.value.setScrollPosition("vertical",999999999,1e3)},_=e=>{if(e){const t=(0,I.LO)(e);let a=`${I.v2.replace("/api","")}/${t}`;return a=a.replace("//uploads","/uploads"),a}return""},b=e=>(0,I.Qm)(e),h=e=>(0,I.Zx)(e),f=e=>{let t=`${I.v2.replace("/api","")}/${e.file_web_path}`;t=t.replace("//uploads","/uploads");let a=`<a href="${t}" target="_blank"><img src="`,l=(0,I.LO)(e.file_web_path);if(e.file_extension){const t=e.file_extension;l="jpg"===t.toLowerCase()||"jpeg"===t.toLowerCase()||"gif"===t.toLowerCase()||"png"===t.toLowerCase()||"bmp"===t.toLowerCase()?(0,I.LO)(e.file_web_path):"pdf"===t.toLowerCase()?"img/file-pdf.jpg":"doc"===t.toLowerCase()||"docx"===t.toLowerCase()?"img/file-doc.jpg":"xls"===t.toLowerCase()||"xlsx"===t.toLowerCase()||"csv"===t.toLowerCase()?"img/file-xls.jpg":"txt"===t.toLowerCase()?"img/file-txt.jpg":"rar"===t.toLowerCase()?"img/file-rar.jpg":"zip"===t.toLowerCase()?"img/file-zip.jpg":"img/file-other.jpg"}l=l.replace("//img/","/img/");let i=`${I.v2.replace("/api","")}/${l}`;return i=i.replace("//uploads/","/uploads/"),i=i.replace("//img/","/img/"),a+=i,a+='"/></a><br>',a+=e.file_name,a},w=(t,l=1,i)=>{i&&(r.value=!0),F.api.post("/get-chat-messages",{bid_id:e.bid_id,rowsPerPage:300,page:l}).then((e=>{i&&(r.value=!1),a.value=e.data.data.data.reverse();let l=!1;a.value&&a.value.length&&a.value.forEach(((e,t)=>{e.file_id&&e.file_web_path&&(a.value[t].message=f(e)),e.read||(l=!0)})),(t||o.value>=.5&&l)&&g()})).catch((e=>{i&&(r.value=!1,(0,I.NU)({},e))}))},v=()=>{a.value.push({message:m.value,from_user_id:p.value.id,from_user_avatar:p.value.avatar,from_user_name:p.value.name}),g(),F.api.post("/send-chat-message",{bid_id:e.bid_id,message:m.value}).then((e=>{e.data.success?(w(!1,1,!1),m.value=""):(0,I.NU)({message:"eroare de server"})})).catch((e=>{(0,I.NU)({},e)}))};let x=null;(0,l.bv)((()=>{d.value=`id${Math.floor(1e5*Math.random())}`,w(!0,1,!0),x=setInterval((()=>{w(!1,1,!1)}),14e3)})),(0,l.Ah)((()=>{clearInterval(x)}));const y=e=>{o.value=e.verticalPercentage},k=e=>{let t=e.read?"text-blue-grey-3":"text-subtitle2";return e.from_user_id===p.value.id&&(t="text-blue-grey-3"),`<span class='${t}'>${e.from_user_name}</span>`},C=()=>{document.getElementById(d.value).click()},D=(t,a)=>{for(let l=0;l<a.length;l+=1){const i=a[l];if(a.length>0){const a=i.size/u.value/u.value;if(i.type.match("image.*")||"application/pdf"===i.type||"application/doc"===i.type||"text/plain"===i.type||i.type.match(".*officedocument.*")||i.type.match(".*excel.*")||i.type.match(".*msword.*")||i.type.match(".*ms-doc.*")||i.type.match(".*zip-compressed.*")||i.name.match(".*rar"))if(a>1)(0,I.NU)({message:`Fișierul este prea mare! Alegeți un fișier mai mic ${u.value/1024}Мб`});else{const a={client_id:e.client_id||null,user_id:e.user_id||null,dealer_id:e.dealer_id||null,bid_id:e.bid_id||null},l=new FormData;l.append(t,i),(0,I.QP)(),F.api.post("/files/uploadFile",l,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{(0,I.Zk)(),e.data.success?F.api.post("/files/linkFileTo",{...a,file_id:e.data.data.id,add_to_chat:!0}).then((()=>{w(!0,1,!1)})):(0,I.NU)({message:"Eroare de încărcare a fișierului pe server!"})})).catch((async e=>{(0,I.Zk)(),(0,I.NU)({message:"Eroare de încărcare a fișierului pe server"},e)}))}else(0,I.NU)({message:"Extensie inacceptabilă. (jpg, jpeg, png, bmp, gif, rar, zip, doc, docx, xls, xlsx, pdf, txt, csv) "})}}};return{messages:a,userDetails:i,otherUserDetails:s,newMessage:m,sendMessage:v,currentUser:p,scrollAreaRef:n,getChatMessageUser:k,getAvatar:_,getInitialsForLogo:b,getColorForLogo:h,chatMessagesLoad:r,launchFilePicker:C,uploadFieldId:d,uploadFieldName:c,onFileChange:D,scrollHandlerArea:y}}};var kt=a(4260),Ct=a(7704),Dt=a(6122),qt=a(629),Ut=a(9570),St=a(4842),Ft=a(2165),It=a(8870),Bt=a(7518),Wt=a.n(Bt);const Tt=(0,kt.Z)(yt,[["render",xt]]),Ht=Tt;Wt()(yt,"components",{QScrollArea:Ct.Z,QCircularProgress:Dt.Z,QChatMessage:qt.Z,QToolbar:Ut.Z,QInput:St.Z,QBtn:Ft.Z,QTooltip:It.Z});var Lt=a(7755),Zt=a(3225),Nt=a(7333),zt=a(932);const Pt={name:"BidDialog",components:{FileUpload:zt.Z,FilesForm:Nt.Z,LogsTableForForms:Zt.Z,HeaderTabsForForms:Lt.Z,Chat:Ht},setup(){const e=(0,S.oR)(),t=(0,B.Z)(),a=(0,U.iH)(!1),i=(0,U.iH)(0),s=(0,U.iH)(null),o=(0,U.iH)({}),n=(0,U.iH)(!1),r=(0,U.iH)(!1),d=(0,U.iH)(!1),c=(0,U.iH)(!1),u=(0,U.iH)(0),m=(0,U.iH)(0),p=(0,U.iH)(0),g=(0,U.iH)(""),_=(0,U.iH)(!1),b=(0,U.iH)(""),h=(0,U.iH)(!1),f=(0,U.iH)(""),w=(0,U.iH)(!1),v=(0,U.iH)(""),x=(0,U.iH)(!1),y=(0,U.iH)(""),k=(0,U.iH)(!1),C=(0,U.iH)(""),D=(0,U.iH)(!1),q=(0,U.iH)(""),W=(0,U.iH)(!1),T=(0,U.iH)(""),H=(0,U.iH)(""),L=(0,U.iH)(""),Z=(0,U.iH)(""),N=(0,U.iH)(""),z=(0,U.iH)(""),P=(0,U.iH)(""),V=(0,U.iH)(!0),A=(0,U.iH)(!0),E=(0,U.iH)(I.sw),j=(0,U.iH)(I.Zg),O=(0,U.iH)(I.ov),Q=(0,U.iH)(I.bq),M=(0,U.iH)(I.XK),R=(0,U.iH)(I.F0),$={};$[String(I.sw)]={},$[String(I.Zg)]={},$[String(I.ov)]={},$[String(I.bq)]={},$[String(I.XK)]={},$[String(I.F0)]={};const Y=(0,U.iH)({...$}),G=(0,l.Fl)((()=>e.getters["auth/getUser"])),K=e=>{if(e){const t=(0,I.LO)(e);let a=`${I.v2.replace("/api","")}/${t}`;return a=a.replace("//uploads","/uploads"),a}return""},J=e=>(0,I.Qm)(e),X=e=>(0,I.Zx)(e),ee=(0,U.iH)([{name:"general",icon:"store",label:"Date generale"},{name:"chat",icon:"chat",label:"Chat"},{name:"files",icon:"folder_open",label:"Fișiere"},{name:"logs",icon:"history",label:"Log"}]),te=(0,U.iH)("general");(0,l.m0)((()=>{n.value=G.value.role_id===I.M6,r.value=G.value.role_id===I.i,d.value=G.value.role_id===I.Vz})),(0,l.m0)((()=>{a.value=e.getters["bids/getOpenedBidForm"],a.value&&("chat"===e.getters["bids/getLastBidTab"]?te.value="chat":te.value="general")})),(0,l.m0)((()=>{o.value=e.getters["bids/getOpenedBidData"]})),(0,l.m0)((()=>{o.value&&(i.value=o.value.id?o.value.id:0,s.value=o.value.status_id?parseInt(o.value.status_id,10):0,u.value=o.value.sum_max_permis,g.value=o.value.first_name,b.value=o.value.last_name,f.value=o.value.phone1,v.value=o.value.buletin_sn,y.value=o.value.buletin_idnp,C.value=(0,I.XZ)(o.value.birth_date),q.value=o.value.localitate,T.value=o.value.street,H.value=o.value.house,L.value=o.value.flat,Z.value=o.value.who_is_cont_pers1,N.value=o.value.phone_cont_pers1,z.value=o.value.last_name_cont_pers1,P.value=o.value.first_name_cont_pers1,m.value=o.value.sum_max,p.value=o.value.sum_min,Object.keys(Y.value).forEach((e=>{Y.value[e]={}})),o.value.files&&Array.isArray(o.value.files)&&o.value.files.length&&o.value.files.forEach((e=>{Object.keys(Y.value).indexOf(String(e.type_id))>-1&&(Y.value[String(e.type_id)]=e)})))}));const ae=()=>{e.commit("bids/updateOpenedBidData",{}),e.commit("bids/updateOpenedBidForm",!1)},le=t=>{i.value=t;const a={...e.getters["bids/getOpenedBidData"]};a.id=t,e.commit("bids/updateOpenedBidData",a),(0,I.QP)(),F.api.get(`/bids/get-data-by-id/${t}`).then((t=>{(0,I.Zk)(),t.data.success?e.commit("bids/updateOpenedBidData",t.data.data):(0,I.NU)({message:t.data.data.message})})).catch((e=>{(0,I.Zk)(),(0,I.NU)({},e)}))},ie=a=>{if(o.value&&o.value.id){const l=()=>{(0,I.QP)(),F.api.post(`/bids/set-bid-status/${i.value}`,{status_id:a,sum_max_permis:u.value}).then((t=>{(0,I.Zk)(),t.data.success?(e.commit("bids/updateOpenedBidData",t.data.data),e.commit("users/updateRefreshGridBidsCalculator",!0)):(0,I.NU)({message:t.data.data.message})})).catch((e=>{(0,I.Zk)(),(0,I.NU)({},e)}))};if(a===I.jh||a===I.vy){let e="Sunteți sigur că doriți să aprobați cererea?";a===I.vy&&(e="Sunteți sigur că doriți să refuzați cererea?"),t.dialog({title:"Atenție",message:e,cancel:!0,persistent:!0}).onOk((()=>{l()}))}else l()}},se=()=>{Y.value[String(I.sw)].name?t.dialog({title:"Atenție",message:"Sunteți sigur că doriți să închideți cererea?",cancel:!0,persistent:!0}).onOk((()=>{ie(I._f)})):t.dialog({title:"Eroare",message:"Nu ați atașat contractul semnat?",color:"negative",cancel:!1,persistent:!0})},oe=()=>{let a=m.value;u.value>p.value&&(a=u.value),t.dialog({title:"Suma cererii de credit",message:`Introdu suma nouă a cererii. min: ${p.value}, max: ${a}`,prompt:{model:"",type:"number",isValid:e=>parseInt(String(e),10)<=a&&parseInt(String(e),10)>=p.value,outlined:!0},cancel:"Închide",ok:{flat:!1},persistent:!0}).onOk((t=>{i.value?((0,I.QP)(),F.api.post(`/bid-change-sum/${i.value}`,{bid_id:i.value,new_sum:t}).then((t=>{(0,I.Zk)(),t.data.success?e.commit("bids/updateOpenedBidData",t.data.data):(0,I.NU)({message:t.data.data.message})})).catch((e=>{(0,I.Zk)(),(0,I.NU)({},e)}))):(0,I.NU)({message:"eroare de id cerere"})}))},ne=()=>{(0,I.WW)(i.value,"/print/contract","contract")},re=e=>{if(e.response.data.data){const t=String(e.linkFileToData.type_id);Y.value[t]=e.response.data.data}};return{id:i,bidData:o,isOpenedLocal:a,onCancelClick:ae,getDataById:le,statusId:s,BID_STATUS_NEW:I.VB,BID_STATUS_IN_WORK:I.j3,BID_STATUS_APPROVED:I.jh,BID_STATUS_REFUSED:I.vy,isExecutor:n,isAdmin:r,isDealer:d,setBidStatus:ie,dateToDot:I.XZ,showAllBidMonths:c,sumMaximPermis:u,disableSumMaximPermis:A,clientFirstName:g,clientFirstNameHasError:_,clientLastName:b,clientLastNameHasError:h,clientPhone:f,clientPhoneHasError:w,clientBuletinSN:v,clientBuletinSNHasError:x,clientBuletinIDNP:y,clientBuletinIDNPHasError:k,clientBirthDate:C,clientBirthDateHasError:D,clientLocalitate:q,clientLocalitateHasError:W,clientStreet:T,clientHouse:H,clientFlat:L,clientWhoIsContPers1:Z,clientPhoneContPers1:N,clientLastNameContPers1:z,clientFirstNameContPers1:P,disableClientInputs:V,tabs:ee,tab:te,openPopupForSumChange:oe,getInitialsForLogo:J,getLogo:K,getColorForLogo:X,printContract:ne,fileTypeSignContract:E,fileTypeUnSignContract:j,fileTypeBuletin1:O,fileTypeBuletin2:Q,fileTypeOthers1:M,fileTypeOthers2:R,fileUploadedResponses:Y,onFileUploaded:re,sendBidToContract:se}}};var Vt=a(6778),At=a(151),Et=a(3747),jt=a(2025),Ot=a(5869),Qt=a(5589),Mt=a(5906),Rt=a(6602),$t=a(9721),Yt=a(4554),Gt=a(5096),Kt=a(4027),Jt=a(9367);const Xt=(0,kt.Z)(Pt,[["render",pt]]),ea=Xt;Wt()(Pt,"components",{QDialog:Vt.Z,QCard:At.Z,QToolbar:Ut.Z,QToolbarTitle:Et.Z,QSpace:jt.Z,QBtn:Ft.Z,QSeparator:Ot.Z,QCardSection:Qt.Z,QTabPanels:Mt.Z,QTabPanel:Rt.Z,QBadge:$t.Z,QIcon:Yt.Z,QAvatar:Gt.Z,QImg:Kt.Z,QInput:St.Z,QCardActions:Jt.Z});const ta=(0,l.aZ)({name:"BidsListForCalculator",components:{BidDialog:ea},setup(){const e=(0,S.oR)(),t=(0,B.Z)(),a=(0,U.iH)([]),i=(0,U.iH)([]),s=(0,U.iH)(!1),o=(0,U.iH)(null),n=(0,U.iH)(""),r=(0,U.iH)(!1),d=(0,U.iH)(!1),c=(0,U.iH)(!1),u=(0,l.Fl)((()=>e.getters["auth/getUser"])),m=(0,U.iH)({sortBy:"id",descending:!0,page:1,rowsPerPage:100}),p=e=>{if(e){const t=(0,I.LO)(e);let a=`${I.v2.replace("/api","")}/${t}`;return a=a.replace("//uploads","/uploads"),a}return""},g=e=>(0,I.Qm)(e),_=e=>(0,I.Zx)(e),b=e=>(0,I.BC)(e),h=e=>e.status_id===I.VB?"bg-white":e.status_id===I.jh?"bg-green-2":e.status_id===I.vy?"bg-red-2":e.status_id===I.j3?"bg-yellow-2":"bg-white",f=e=>e===I.VB?"white":e===I.jh?"positive":e===I.vy?"negative":e===I.j3?"yellow":"white",w=e=>e===I.VB?"black":e===I.jh||e===I.vy?"white":(I.j3,"black"),v=t=>{e.commit("users/updateRefreshGridBidsCalculator",!1),s.value=!0,F.api.post("/bids/get-list",{...t,activeModule:e.getters["auth/getActiveModule"]}).then((e=>{s.value=!1,e.data.success&&(a.value=[...e.data.data.data],m.value.page=e.data.data.current_page,m.value.rowsPerPage=e.data.data.per_page,m.value.rowsNumber=e.data.data.total)})).catch((e=>{s.value=!1,(0,I.NU)({},e)}))},x=(t,a=!1)=>{e.commit("bids/updateOpenedBidData",{id:t}),e.commit("bids/updateOpenedBidForm",!0),e.commit("bids/updateLastBidTab",a?"chat":"general"),t>0&&o.value&&o.value.getDataById(t)},y=e=>{t.dialog({title:"Atenție",message:"Sunteți sigur că doriți să ștergeți?",cancel:!0,persistent:!0}).onOk((()=>{F.api["delete"](`/bids/${e.row.id}`).then((()=>{v()}))}))};(0,l.m0)((()=>{r.value=u.value.role_id===I.M6,d.value=u.value.role_id===I.i,c.value=u.value.role_id===I.Vz})),(0,l.m0)((()=>{e.getters["users/getRefreshGridBidsCalculator"]&&v()})),(0,l.m0)((()=>{const t=e.getters["auth/getCheckNewMessages"];if(t&&t.unreadMessages){const e=[];t.unreadMessages.forEach((t=>{t.bid_id&&(void 0===e[t.bid_id]&&(e[t.bid_id]=0),e[t.bid_id]+=1)})),i.value=e,t.bids&&(console.log(t.bids),t.bids.forEach((e=>{let t=!1;a.value.forEach(((l,i)=>{l.id===e.id&&(t=!0,l.status_id===e.status_id&&l.imprumut===e.imprumut||(a.value[i]=e))})),t||(a.value=[e,...a.value])})))}})),(0,l.bv)((()=>{v()})),(0,l.wF)((()=>{a.value=[]}));const k=[{name:"id",label:"ID",field:"id",sortable:!0,style:"width: 20px",align:"center",classes:e=>h(e)},{name:"dealer_name",label:"Dealer",field:"dealer_name",sortable:!0,align:"left",classes:e=>h(e)},{name:"phone1",label:"Client",field:"phone1",sortable:!0,align:"left",classes:e=>h(e)}];return{loading:s,pagination:m,columns:k,rows:a,onRequest:v,filter:n,getLogo:p,getInitialsForLogo:g,getColorForLogo:_,editRow:x,deleteRow:y,getBidStatus:b,getRowClasses:h,getStatusBadgeColor:f,getStatusBadgeTextColor:w,BidDialogRef:o,unreadChats:i,isExecutor:r,isDealer:c,isAdmin:d}}});var aa=a(8107),la=a(3884);const ia=(0,kt.Z)(ta,[["render",q]]),sa=ia;Wt()(ta,"components",{QTable:aa.Z,QInput:St.Z,QIcon:Yt.Z,QBtn:Ft.Z,QTooltip:It.Z,QTd:la.Z,QBadge:$t.Z,QAvatar:Gt.Z,QImg:Kt.Z})},9517:(e,t,a)=>{a.d(t,{Z:()=>k});var l=a(3673);const i={style:{"text-align":"center"}},s=(0,l.Uk)("Schimbă imaginea"),o=(0,l.Uk)("Schimbă imaginea"),n=["src"],r={key:1,style:{color:"#4f4c4e","font-size":"23px","text-align":"center"}},d=["id","name"];function c(e,t,a,c,u,m){const p=(0,l.up)("q-tooltip"),g=(0,l.up)("q-img"),_=(0,l.up)("q-icon"),b=(0,l.up)("q-avatar"),h=(0,l.up)("q-btn");return(0,l.wg)(),(0,l.iD)("div",i,[m.linkToImage&&"dealer"===a.isFor?((0,l.wg)(),(0,l.j4)(g,{key:0,src:m.linkToImage,class:"rounded-borders cursor-pointer",onClick:m.launchFilePicker,style:{"max-width":"100%","max-height":"140px",border:"1px solid rgba(79,76,78,0.35)",margin:"auto"},alt:""},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[s])),_:1})])),_:1},8,["src","onClick"])):((0,l.wg)(),(0,l.j4)(h,{key:1,round:"",onClick:m.launchFilePicker},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{size:"140px",class:"cursor-pointer",style:{border:"1px solid #4f4c4e",margin:"auto"}},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[o])),_:1}),m.linkToImage?((0,l.wg)(),(0,l.iD)("img",{key:0,src:m.linkToImage,alt:""},null,8,n)):"dealer"===a.isFor?((0,l.wg)(),(0,l.iD)("div",r," Logo Company ")):((0,l.wg)(),(0,l.j4)(_,{key:2,color:"blue-grey-5",style:{margin:"auto"},name:"person_outline"}))])),_:1})])),_:1},8,["onClick"])),(0,l._)("input",{type:"file",ref:"file",id:m.uploadFieldId,name:u.uploadFieldName,onChange:t[0]||(t[0]=e=>m.onFileChange(e.target.name,e.target.files)),style:{display:"none"}},null,40,d)])}a(5363);var u=a(5474),m=a(3413);const p={name:"AvatarUploadField",props:{id:{type:Number,default:0},linkToCurrentImage:{type:String,default:""},isFor:{type:String,default:"user"}},data(){return{maxSize:80480,errorText:"",uploadFieldName:"fileForUpload",linkToImageUpdatedNow:""}},computed:{uploadFieldId(){return`id${Math.floor(1e5*Math.random())}`},linkToImage(){let e="";if(this.linkToImageUpdatedNow?e=this.linkToImageUpdatedNow:this.linkToCurrentImage&&(e=this.linkToCurrentImage),""!==e){e=(0,m.LO)(e);const t=String(u.api.defaults.baseURL);return`${t.replace("/api","")}/${e}`}return""}},methods:{launchFilePicker(){this.id?document.getElementById(this.uploadFieldId).click():(0,m.NU)({message:"Pentru a adăuga imaginea, mai întâi trebuie să salvați",color:"info"})},onFileChange(e,t){if(this.id){const{maxSize:a}=this;for(let l=0;l<t.length;l+=1){const i=t[l];if(t.length>0){const t=i.size/a/a;if(i.type.match("image.*"))if(t>1)(0,m.NU)({message:`Fișierul este prea mare! Alegeți un fișier mai mic ${this.maxSize/1024}Мб`});else{const t=new FormData;t.append(e,i),(0,m.QP)(),u.api.post("/files/uploadFile",t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{if((0,m.Zk)(),e.data.success){this.file_id=e.data.data.id,this.file_web_path=e.data.data.web_path,this.linkToImageUpdatedNow=e.data.data.web_path;const t={file_id:e.data.data.id,makeAvatar:1};"dealer"===this.isFor?t.dealer_id=this.id:t.user_id=this.id,u.api.post("/files/linkFileTo",t)}else(0,m.NU)({message:"Eroare de încărcare a fișierului pe server"})})).catch((()=>{(0,m.Zk)(),(0,m.NU)({message:"Eroare de încărcare a fișierului pe server"})}))}else(0,m.NU)({message:"Extensie inacceptabilă. (jpg, jpeg, png, bmp, gif) "})}}}else(0,m.NU)({message:"Pentru a adăuga imaginea, mai întâi trebuie să salvați",color:"info"})}}};var g=a(4260),_=a(4027),b=a(8870),h=a(2165),f=a(5096),w=a(4554),v=a(7518),x=a.n(v);const y=(0,g.Z)(p,[["render",c]]),k=y;x()(p,"components",{QImg:_.Z,QTooltip:b.Z,QBtn:h.Z,QAvatar:f.Z,QIcon:w.Z})},932:(e,t,a)=>{a.d(t,{Z:()=>x});var l=a(3673);const i=["id","name"],s=["id","name"],o=(0,l._)("div",{class:"files-card__overlay"},null,-1),n=(0,l._)("div",{class:"text-subtitle1"},"Adaugă fișier nou",-1);function r(e,t,a,r,d,c){const u=(0,l.up)("q-icon"),m=(0,l.up)("q-card-section"),p=(0,l.up)("q-btn"),g=(0,l.up)("q-card-actions"),_=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",null,[c.showJustFileInput?((0,l.wg)(),(0,l.iD)("input",{key:0,type:"file",ref:"file",multiple:"",id:c.uploadFieldId,name:d.uploadFieldName,onChange:t[0]||(t[0]=e=>c.onFileChange(e.target.name,e.target.files)),value:"Alege fișierul",style:{"font-size":"18px",padding:"25px",background:"#5ddcc6"}},null,40,i)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l._)("input",{type:"file",ref:"file",multiple:"",id:c.uploadFieldId,name:d.uploadFieldName,onChange:t[1]||(t[1]=e=>c.onFileChange(e.target.name,e.target.files)),style:{display:"none"}},null,40,s),c.hasButtonSlot?((0,l.wg)(),(0,l.iD)("div",{key:0,onClick:t[2]||(t[2]=e=>c.launchFilePicker())},[(0,l.WI)(e.$slots,"button")])):((0,l.wg)(),(0,l.j4)(_,{key:1,onClick:t[3]||(t[3]=e=>c.launchFilePicker()),class:"files-card bg-primary text-white cursor-pointer"},{default:(0,l.w5)((()=>[o,(0,l.Wm)(m,{class:"text-center",style:{height:"100px"}},{default:(0,l.w5)((()=>[n,(0,l.Wm)(u,{class:"",name:"add",size:"xl"})])),_:1}),(0,l.Wm)(g,{align:"around"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{dense:"",size:"sm",icon:"",flat:""}),(0,l.Wm)(p,{dense:"",size:"sm",icon:"",flat:""})])),_:1})])),_:1}))],64))])}var d=a(3413),c=a(5474);const u={name:"FileUpload",props:{module:{type:String,default:""},id:{type:Number,default:0},typeId:{type:Number,default:null}},data(){return{errorText:"",uploadFieldName:"fileForUpload",maxSize:20480}},emits:["onUploaded"],computed:{hasButtonSlot(){return!!this.$slots.button},uploadFieldId(){return`id${Math.floor(1e5*Math.random())}`},showJustFileInput(){return this.$q.platform.is.ios}},methods:{launchFilePicker(){document.getElementById(this.uploadFieldId).click()},onFileChange(e,t){const{maxSize:a}=this;for(let l=0;l<t.length;l+=1){const i=t[l];if(t.length>0){const t=i.size/a/a;if(i.type.match("image.*")||"application/pdf"===i.type||"application/doc"===i.type||"text/plain"===i.type||i.type.match(".*officedocument.*")||i.type.match(".*excel.*")||i.type.match(".*msword.*")||i.type.match(".*ms-doc.*")||i.type.match(".*zip-compressed.*")||i.name.match(".*rar"))if(t>1)(0,d.NU)({message:`Fișierul este prea mare! Alegeți un fișier mai mic ${this.maxSize/1024}Мб`});else{const t={client_id:"client_id"===this.module?this.id:null,user_id:"user_id"===this.module?this.id:null,dealer_id:"dealer_id"===this.module?this.id:null,bid_id:"bid_id"===this.module?this.id:null},a=new FormData;a.append(e,i),(0,d.QP)(),c.api.post("/files/uploadFile",a,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{if((0,d.Zk)(),e.data.success){const a={...t,file_id:e.data.data.id,type_id:this.typeId};c.api.post("/files/linkFileTo",a).then((t=>{this.$emit("onUploaded",{response2:t,response:e,linkFileToData:a})}))}else(0,d.NU)({message:"Eroare de încărcare a fișierului pe server!"})})).catch((async e=>{(0,d.Zk)(),(0,d.NU)({message:"Eroare de încărcare a fișierului pe server"},e)}))}else(0,d.NU)({message:"Extensie inacceptabilă. (jpg, jpeg, png, bmp, gif, rar, zip, doc, docx, xls, xlsx, pdf, txt, csv) "})}}}}};var m=a(4260),p=a(151),g=a(5589),_=a(4554),b=a(9367),h=a(2165),f=a(7518),w=a.n(f);const v=(0,m.Z)(u,[["render",r]]),x=v;w()(u,"components",{QCard:p.Z,QCardSection:g.Z,QIcon:_.Z,QCardActions:b.Z,QBtn:h.Z})},7333:(e,t,a)=>{a.d(t,{Z:()=>I});var l=a(3673),i=a(2323);const s={class:"files-form"},o={key:0,class:"row"},n={class:"col-xl-2 col-lg-2 col-md-3 col-sm-6 col-xs-12 q-pa-sm"},r=["href"],d={class:"absolute-bottom"},c={class:""},u=(0,l.Uk)(" Deschide "),m={class:"text-blue-grey-5 text-caption"},p=(0,l.Uk)("Șterge"),g={key:1};function _(e,t,a,_,b,h){const f=(0,l.up)("file-upload"),w=(0,l.up)("q-icon"),v=(0,l.up)("q-tooltip"),x=(0,l.up)("q-img"),y=(0,l.up)("q-btn"),k=(0,l.up)("q-card-actions"),C=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",s,[h.idExist?((0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("div",n,[(0,l.Wm)(f,{module:h.module,id:h.id,onOnUploaded:h.load},null,8,["module","id","onOnUploaded"])]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.files,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"col-xl-2 col-lg-2 col-md-3 col-sm-6 col-xs-12 q-pa-sm",key:e.title},[(0,l.Wm)(C,{class:"files-card"},{default:(0,l.w5)((()=>[(0,l._)("a",{href:e.downloadLink,download:"",target:"_blank"},[(0,l.Wm)(x,{src:e.cardSrc,style:{height:"100px",cursor:"pointer"}},{default:(0,l.w5)((()=>[(0,l._)("div",d,[(0,l._)("div",c,(0,i.zw)(e.name),1)]),e.id>0?((0,l.wg)(),(0,l.j4)(v,{key:0,"content-class":"bg-positive","content-style":"font-size: 16px",offset:[10,10],anchor:"bottom middle",self:"bottom middle"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{name:"visibility"}),u])),_:1})):(0,l.kq)("",!0)])),_:2},1032,["src"])],8,r),(0,l.Wm)(k,{align:"around"},{default:(0,l.w5)((()=>[(0,l._)("span",m,(0,i.zw)(e.created_at2),1),e.id>0?((0,l.wg)(),(0,l.j4)(y,{key:0,dense:"",size:"sm",onClick:t=>h.deleteFile(e.id),icon:"delete",color:"blue-grey-3",round:"",flat:""},{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[p])),_:1})])),_:2},1032,["onClick"])):(0,l.kq)("",!0)])),_:2},1024)])),_:2},1024)])))),128))])):((0,l.wg)(),(0,l.iD)("div",g," Fișierele pot fi adăugate doar după ce documentul va fi salvat "))])}a(5363);var b=a(3413),h=a(5474),f=a(932);const w={name:"FilesForm",props:{client_id:{type:Number,default:0},bid_id:{type:Number,default:0},user_id:{type:Number,default:0},dealer_id:{type:Number,default:0}},components:{FileUpload:f.Z},data:()=>({files:[]}),computed:{idExist(){return this.bid_id||this.user_id||this.client_id||this.dealer_id},module(){return this.bid_id?"bid_id":this.user_id?"user_id":this.client_id?"client_id":this.dealer_id?"dealer_id":""},id(){return this.bid_id?this.bid_id:this.user_id?this.user_id:this.client_id?this.client_id:this.dealer_id?this.dealer_id:0}},methods:{load(){this.files=[],this.idExist&&h.api.post("/files/getFiles",{client_id:this.client_id,user_id:this.user_id,dealer_id:this.dealer_id,bid_id:this.bid_id}).then((e=>{e.data.success&&(this.files=e.data.data.data,this.files.map((e=>{"jpg"===e.extension.toLowerCase()||"jpeg"===e.extension.toLowerCase()||"gif"===e.extension.toLowerCase()||"png"===e.extension.toLowerCase()||"bmp"===e.extension.toLowerCase()?e.cardSrc=(0,b.LO)(e.web_path):"pdf"===e.extension.toLowerCase()?e.cardSrc="img/file-pdf.jpg":"doc"===e.extension.toLowerCase()||"docx"===e.extension.toLowerCase()?e.cardSrc="img/file-doc.jpg":"xls"===e.extension.toLowerCase()||"xlsx"===e.extension.toLowerCase()||"csv"===e.extension.toLowerCase()?e.cardSrc="img/file-xls.jpg":"txt"===e.extension.toLowerCase()?e.cardSrc="img/file-txt.jpg":"rar"===e.extension.toLowerCase()?e.cardSrc="img/file-rar.jpg":"zip"===e.extension.toLowerCase()?e.cardSrc="img/file-zip.jpg":e.cardSrc="img/file-other.jpg";const t=String(h.api.defaults.baseURL).replace("/api","");return e.cardSrc=`${t}/${e.cardSrc}`,e.downloadLink=`${t}/${e.web_path}`,e})))}))},deleteFile(e){this.$q.dialog({title:"Atenție",message:"Sunteți sigur că doriți să ștergeți?",ok:{label:"Șterge",flat:!1,size:"lg"},cancel:{label:"Închide",flat:!0},persistent:!0}).onOk((()=>{h.api.post("/files/deleteFile",{id:e}).then((()=>{this.load()}))}))}},watch:{client_id(){this.load()},user_id(){this.load()}},mounted(){this.load()}};var v=a(4260),x=a(151),y=a(4027),k=a(8870),C=a(4554),D=a(9367),q=a(2165),U=a(7518),S=a.n(U);const F=(0,v.Z)(w,[["render",_]]),I=F;S()(w,"components",{QCard:x.Z,QImg:y.Z,QTooltip:k.Z,QIcon:C.Z,QCardActions:D.Z,QBtn:q.Z})},7755:(e,t,a)=>{a.d(t,{Z:()=>v});var l=a(3673),i=a(2323);function s(e,t,a,s,o,n){const r=(0,l.up)("q-tab"),d=(0,l.up)("q-tabs"),c=(0,l.up)("q-icon"),u=(0,l.up)("q-item-section"),m=(0,l.up)("q-item-label"),p=(0,l.up)("q-item"),g=(0,l.up)("q-list"),_=(0,l.up)("q-btn-dropdown"),b=(0,l.Q2)("close-popup");return n.isMobile?((0,l.wg)(),(0,l.j4)(_,{key:1,color:"primary",flat:"",dense:"",icon:o.activeIcon,label:o.activeLabel},{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.tabs,((e,t)=>((0,l.wg)(),(0,l.iD)(l.HY,null,[e.hidden?(0,l.kq)("",!0):(0,l.wy)(((0,l.wg)(),(0,l.j4)(p,{clickable:"",onClick:t=>n.setModelObject(e.name),key:`tabIcon-${t}`},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{name:e.icon,color:"primary",flat:""},null,8,["name"])])),_:2},1024),(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{class:"text-primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])),[[b]])],64)))),256))])),_:1})])),_:1},8,["icon","label"])):((0,l.wg)(),(0,l.j4)(d,{key:0,modelValue:o.model,"onUpdate:modelValue":t[0]||(t[0]=e=>o.model=e),"narrow-indicator":"",dense:"",align:"justify",class:"text-primary"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.tabs,((e,t)=>((0,l.wg)(),(0,l.iD)(l.HY,null,[e.hidden?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(r,{key:`tab-${t}`,ripple:!1,onClick:t=>n.setModel(e.name),name:e.name,icon:e.icon,label:e.label},null,8,["onClick","name","icon","label"]))],64)))),256))])),_:1},8,["modelValue"]))}const o={name:"HeaderTabsForForms",props:{value:{type:String,default:""},tabs:{type:Array,default(){return[]}}},data(){return{model:"",activeIcon:"",activeName:"",activeLabel:""}},emits:["input"],computed:{isMobile(){return this.$q.screen.lt.md}},methods:{setModel(e){this.model=e,this.$emit("input",this.model)},setModelObject(e){this.tabs.forEach((t=>{t.name===e&&(this.setModel(e),this.activeName=e,this.activeIcon=t.icon,this.activeLabel=t.label)}))}},watch:{model(e){this.setModelObject(e)}},mounted(){this.setModelObject(this.value)}};var n=a(4260),r=a(7547),d=a(3269),c=a(2670),u=a(7011),m=a(3414),p=a(2035),g=a(4554),_=a(2350),b=a(677),h=a(7518),f=a.n(h);const w=(0,n.Z)(o,[["render",s]]),v=w;f()(o,"components",{QTabs:r.Z,QTab:d.Z,QBtnDropdown:c.Z,QList:u.Z,QItem:m.Z,QItemSection:p.Z,QIcon:g.Z,QItemLabel:_.Z}),f()(o,"directives",{ClosePopup:b.Z})},3225:(e,t,a)=>{a.d(t,{Z:()=>g});a(246);var l=a(3673);const i=["innerHTML"];function s(e,t,a,s,o,n){const r=(0,l.up)("q-td"),d=(0,l.up)("q-table");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(d,{class:"full-width sticky-header-table",title:"",data:o.data,columns:n.columns,"row-key":"id",flat:!0,dense:!0,loading:o.loading,selection:"none",pagination:o.pagination,"onUpdate:pagination":t[0]||(t[0]=e=>o.pagination=e),"no-data-label":" ","hide-bottom":!1,"rows-per-page-label":" ","rows-per-page-options":[100,200,500,1e3,0],onRequest:n.onRequest},{"body-cell-description":(0,l.w5)((e=>[(0,l.Wm)(r,{props:e},{default:(0,l.w5)((()=>[(0,l._)("div",{innerHTML:n.getDesc(e.row.description)},null,8,i)])),_:2},1032,["props"])])),_:1},8,["data","columns","loading","pagination","onRequest"])])}var o=a(3413);const n={props:{entity_id:{type:Number},entity_name:{type:String}},components:{},data(){return{dataLink:"/logs",loading:!1,selected:[],filter:"",baseURL:o.v2,pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:100,rowsNumber:0},data:[],operationItems:[{value:"e",text:"Editare"},{value:"a",text:"Adăugare"},{value:"d",text:"Ștergere"},{value:"l",text:"Login"},{value:"o",text:"Logout"}]}},computed:{columns(){return[{name:"id",label:"id",align:"center",sortable:!0,field:e=>e.id,format:e=>e,style:"width: 40px"},{name:"created_at2",label:"Data",align:"center",field:e=>e.created_at2,format:e=>`${e}`},{name:"user_name",required:!0,label:"Utilizator",align:"left",field:e=>e.user_name,format:e=>`${e}`,sortable:!0},{name:"ip",required:!0,label:"IP",align:"left",field:e=>e.ip,format:e=>`${e}`,sortable:!0},{name:"operation",required:!0,label:"Operație",align:"left",field:e=>e.operation_name,format:e=>`${e}`,sortable:!0},{label:"Modul",align:"left",name:"entity_name",field:e=>e.entity_name2,format:e=>`${e}`,sortable:!0},{label:"ID Unitate",align:"left",name:"entity_id",field:e=>e.entity_id,sortable:!0},{label:"Descriere",align:"left",name:"description",field:e=>e.description,format:e=>`${e}`,sortable:!1}]}},methods:{getOperationName(e){let t=e;return"e"===e?t="editare":"a"===e?t="adaugare":"d"===e?t="stergere":"l"===e?t="login":"o"===e&&(t="logout"),t},getEntityName(e){return(0,o.C_)(e)},getDesc(e){return e=null!==e&&e&&e.length?e.split("<< >>").join('<strong style="color:#000;">-</strong>').split("<<>>").join('<strong style="color:#000;">-</strong>').split("<<").join('<strong style="color:#000;">').split(">>").join("</strong>"):"",e?`<span style="color:#999;">${e}</span>`:""},onRequest(e={},t={}){const{filter:a}=this,{pagination:l}=this;if(e&&e.pagination){const{rowsPerPage:t,sortBy:a,descending:i}=e.pagination;l.sortBy=a,l.descending=i,e.pagination.page&&(l.page=e.pagination.page),l.rowsPerPage=t}this.loading=!0,this.$axios.post(this.dataLink,{pagination:l,filter:a,filters:{entity_id:this.entity_id,entity_name:this.entity_name},...t}).then((e=>{e.data.success&&(this.data=e.data.data.data,this.pagination.page=e.data.data.current_page,this.pagination.rowsPerPage=e.data.data.per_page,this.pagination.rowsNumber=e.data.data.total),this.loading=!1})).catch((()=>{this.loading=!1}))}},watch:{entity_id(){this.onRequest()}},mounted(){this.onRequest()}};var r=a(4260),d=a(8107),c=a(3884),u=a(7518),m=a.n(u);const p=(0,r.Z)(n,[["render",s]]),g=p;m()(n,"components",{QTable:d.Z,QTd:c.Z})}}]);