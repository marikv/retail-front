"use strict";(self["webpackChunkretail_creditbox_md"]=self["webpackChunkretail_creditbox_md"]||[]).push([[183],{6183:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Q});var l=t(3673),o=t(8880),n=t(2323);const r=(0,l.Uk)("Caută"),i=(0,l.Uk)("Adaugă"),s=(0,l.Uk)("Redactează"),d=(0,l.Uk)("Șterge");function u(e,a,t,u,m,c){const p=(0,l.up)("q-input"),g=(0,l.up)("q-icon"),f=(0,l.up)("q-tooltip"),w=(0,l.up)("q-btn"),b=(0,l.up)("q-td"),_=(0,l.up)("q-img"),y=(0,l.up)("q-avatar"),v=(0,l.up)("q-table"),h=(0,l.up)("User"),k=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(k,{class:"flex flex-block"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"full-width sticky-header-table",flat:!0,title:"Payments",rows:e.rows,columns:e.columns,"row-key":"id",pagination:e.pagination,"onUpdate:pagination":a[3]||(a[3]=a=>e.pagination=a),loading:e.loading,filter:e.filter,"binary-state-sort":"","no-data-label":"Nu sunt înregistrări","rows-per-page-label":"Înregistrări pe pagină","rows-per-page-options":[30,50,100,200,500,1e3,0],onRequest:e.onRequest},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(p,{outlined:"","bg-color":"white",dense:"",debounce:"300",modelValue:e.contractNumber,"onUpdate:modelValue":a[0]||(a[0]=a=>e.contractNumber=a),onKeyup:(0,o.D2)(e.onRequest,["enter"]),class:"q-mr-xs",label:"Nr contract"},null,8,["modelValue","onKeyup"]),(0,l.Wm)(p,{outlined:"","bg-color":"white",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":a[1]||(a[1]=a=>e.filter=a),onKeyup:(0,o.D2)(e.onRequest,["enter"]),placeholder:"Caută"},{append:(0,l.w5)((()=>[(0,l.Wm)(g,{name:"search"})])),_:1},8,["modelValue","onKeyup"]),(0,l.Wm)(w,{icon:"search",round:"",onClick:e.onRequestWithLast,class:"q-ml-lg",color:"primary"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[r])),_:1})])),_:1},8,["onClick"]),(0,l.Wm)(w,{icon:"add",round:"",onClick:a[2]||(a[2]=a=>e.showUserModalSetValue(!0)),class:"q-ml-lg",color:"positive"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[i])),_:1})])),_:1})])),"body-cell-actions":(0,l.w5)((a=>[(0,l.Wm)(b,{props:a,class:"actions-td"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{dense:"",round:"",flat:"",size:"sm",color:"positive",onClick:t=>e.editRow(a),icon:"edit"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[s])),_:1})])),_:2},1032,["onClick"]),(0,l.Wm)(w,{dense:"",round:"",flat:"",size:"sm",color:"negative",onClick:t=>e.deleteRow(a),icon:"delete"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[d])),_:1})])),_:2},1032,["onClick"])])),_:2},1032,["props"])])),"body-cell-dealer_name":(0,l.w5)((a=>[(0,l.Wm)(b,{props:a,class:"props-td"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{style:{border:"1px solid #dddddd"}},{default:(0,l.w5)((()=>[e.getAvatar(a.row.logo)?((0,l.wg)(),(0,l.j4)(_,{key:0,src:e.getAvatar(a.row.logo),alt:""},null,8,["src"])):((0,l.wg)(),(0,l.iD)("div",{key:1,style:(0,n.j5)(`color: ${e.getColorForLogo(a.row.dealer_name)}`)},(0,n.zw)(e.getInitialsForLogo(a.row.dealer_name)),5))])),_:2},1024),(0,l.Uk)(" "+(0,n.zw)(a.row.dealer_name),1)])),_:2},1032,["props"])])),_:1},8,["rows","columns","pagination","loading","filter","onRequest"]),(0,l.Wm)(h,{ref:"UserRef",onOnCloseDialog:a[4]||(a[4]=a=>e.showUserModalSetValue(!1))},null,512)])),_:1})}t(5363);var m=t(1959),c=t(3617),p=t(5474),g=t(3413),f=t(7729),w=t(8825);const b=[{name:"id",label:"ID",field:"id",sortable:!0,style:"width: 50px"},{name:"bid_id",label:"Contract",field:"bid_id",sortable:!0,align:"center",style:"width: 50px"},{name:"dealer_name",label:"Dealer",field:"dealer_name",sortable:!0,align:"center",style:"width: 50px"},{name:"date_time",label:"Data așteptată",field:"date_time",sortable:!0,align:"center",style:"width: 80px",format:e=>e?(0,g.XZ)(e):""},{name:"date_time_fact",label:"Data facto",field:"date_time_fact",sortable:!0,align:"center",style:"width: 80px",format:e=>e?(0,g.$M)(e):""},{name:"beznal",label:"Banca/Numerar",field:"beznal",sortable:!0,align:"left",format:e=>e?"Banca":"Numerar"},{name:"payment_sum",label:"Suma rata",field:"payment_sum",sortable:!0,align:"left"},{name:"payment_sum_fact",label:"Suma facto",field:"payment_sum_fact",sortable:!0,align:"left"},{name:"client_last_name",label:"Client",field:"client_last_name",sortable:!0,align:"left",format:(e,a)=>e?`${a.client_last_name} ${a.client_first_name}`:""},{name:"created_at2",label:"Adăugat",field:"created_at2",sortable:!0},{name:"actions",label:"",align:"center",style:"width: 60px"}],_=(0,l.aZ)({name:"Payments",components:{User:f.Z},setup(){const e=(0,w.Z)(),a=(0,m.iH)([]),t=(0,m.iH)(null),o=(0,m.iH)(""),n=(0,m.iH)(null),r=(0,m.iH)(!1),i=(0,c.oR)(),s=(0,m.iH)(null);i.commit("auth/updateActiveModule","Payments");const d=(0,m.iH)({sortBy:"id",descending:!0,page:1,rowsPerPage:30}),u=e=>{if(e){const a=(0,g.LO)(e),t=String(p.api.defaults.baseURL);return`${t.replace("/api","")}/${a}`}return""},f=e=>(0,g.Qm)(e),_=e=>(0,g.Zx)(e),y=e=>{r.value=!0,s.value=e,i.commit("payments/updateRefreshGrid",!1),p.api.post("/payments-list",{...e,contractNumber:n.value}).then((e=>{r.value=!1,e.data.success&&(a.value=e.data.data.data,d.value.page=e.data.data.current_page,d.value.rowsPerPage=e.data.data.per_page,d.value.rowsNumber=e.data.data.total)})).catch((e=>{r.value=!1,(0,g.NU)({},e)}))},v=(e,a=0)=>{i.commit("payments/updateOpenedUserForm",e),i.commit("payments/updateOpenedUserData",{}),e&&a>0&&t.value&&t.value.getDataById(a)},h=e=>{v(!0,e.row.id)},k=a=>{e.dialog({title:"Atenție",message:"Sunteți sigur că doriți să ștergeți?",cancel:!0,persistent:!0}).onOk((()=>{p.api["delete"](`/payments/${a.row.id}`).then((()=>{y(s.value)}))}))},q=()=>{y(s.value)};return(0,l.m0)((()=>{i.getters["payments/getRefreshGrid"]&&y(s.value)})),(0,l.bv)((()=>{y({pagination:d.value,filter:void 0})})),{filter:o,loading:r,pagination:d,columns:b,rows:a,showUserModalSetValue:v,editRow:h,deleteRow:k,onRequest:y,contractNumber:n,UserRef:t,getAvatar:u,getColorForLogo:_,getInitialsForLogo:f,onRequestWithLast:q}}});var y=t(4260),v=t(4379),h=t(8107),k=t(4842),q=t(4554),R=t(2165),U=t(8870),W=t(3884),C=t(5096),Z=t(4027),x=t(7518),D=t.n(x);const N=(0,y.Z)(_,[["render",u]]),Q=N;D()(_,"components",{QPage:v.Z,QTable:h.Z,QInput:k.Z,QIcon:q.Z,QBtn:R.Z,QTooltip:U.Z,QTd:W.Z,QAvatar:C.Z,QImg:Z.Z})}}]);